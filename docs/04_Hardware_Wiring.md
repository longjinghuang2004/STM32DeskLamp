# 硬件引脚分配与接线指南

本系统涉及两块核心板及多个外设，请严格按照以下引脚定义进行连线。

## 1. ESP32-S3 (大脑端) 引脚分配

| 功能模块 | 引脚 (GPIO) | 说明 |
| :--- | :--- | :--- |
| **UART (To STM32)** | TX: 17, RX: 18 | 与 STM32 交叉连接 (TX接RX) |
| **I2S 麦克风 (INMP441)** | WS: 41, SCK: 42, SD: 40 | 负责语音采集 |
| **I2S 功放 (MAX98357A)** | LRCK: 41, BCLK: 42, DIN: 39 | 负责 TTS 语音播放 (时钟与Mic复用) |
| **物理按键** | 21 | 外接按钮，另一端接 GND (内部上拉) |
| **LCD 屏幕 (8080并口)** | D0-D7: 4-11<br>WR: 12, CS: 13, DC: 14, RST: 15 | 预留给后续 LVGL UI 显示 |

## 2. STM32F103C8T6 (小脑端) 引脚分配

| 功能模块 | 引脚 | 说明 |
| :--- | :--- | :--- |
| **UART (To ESP32)** | TX: PA9, RX: PA10 | 与 ESP32 交叉连接 |
| **PWM LED 驱动** | Warm: PA6, Cold: PA7 | 连接至双色温 LED 驱动板 (TIM3_CH1/2) |
| **I2C1 (OLED 屏幕)** | SCL: PB8, SDA: PB9 | 本地状态显示 |
| **I2C2 (PAJ7620)** | SCL: PB10, SDA: PB11 | 手势传感器 |
| **EC11 编码器** | A: PB6, B: PB7 | 旋钮调光 (TIM4 编码器模式) |
| **编码器按键** | PB1 | 模式切换按键 |
| **DHT11 温湿度** | PA1 | 单总线传感器 |
| **光敏电阻 (LDR)** | PA0 | ADC1_IN0 采集环境光强 |

## 3. 供电与接线注意事项

1.  **共地 (GND)**：ESP32、STM32 以及所有外设模块的 GND 必须可靠连接在一起，否则 UART 和 I2C 通信会产生乱码。
2.  **大电流外设**：音频功放 (MAX98357A) 和 LED 驱动板在工作时电流较大，**严禁**直接从单片机的 3.3V 引脚取电，必须直接连接到 5V 电源轨或独立的电源模块。
3.  **电平匹配**：ESP32 和 STM32F103 的 GPIO 均为 3.3V 逻辑电平，UART 可直接相连，无需电平转换芯片。
